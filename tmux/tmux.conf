# tmux config

# Tips and tricks taken from tmux: Productive Mouse-Free Development by Brian P. Hogan

# Note: since CMD-a is basically useless in tmux, I'm using the app BetterTouchTool
# to remap it to the default prefix (C-b) for me.
# Similarly, I'm using CMD-x to cycle through panes (Prefix o)

# Source/reload this file (Prefix r)
bind r source-file ~/.tmux.conf \; display "Reloaded ~/.tmux.conf!"

# Allow scrolling in panes
set -g mode-mouse on

# Use 256-color terminal colors
set -g default-terminal "screen-256color"

# Remove delay when sending commands (helps with vim)
set -s escape-time 0

# Change window and pane numbering from cardinal (0) to ordinal (1)
set -g base-index 1
setw -g pane-base-index 1

# Use vi-style movements in copy mode
setw -g mode-keys vi

# Smart pane switching with awareness of vim splits
# See: https://github.com/christoomey/vim-tmux-navigator
is_vim='echo "#{pane_current_command}" | grep -iqE "(^|\/)g?(view|n?vim?x?)(diff)?$"'
bind -n C-h if-shell "$is_vim" "send-keys C-w h" "select-pane -L"
bind -n C-j if-shell "$is_vim" "send-keys C-j" "select-pane -D"
bind -n C-k if-shell "$is_vim" "send-keys C-k" "select-pane -U"
bind -n C-l if-shell "$is_vim" "send-keys C-l" "select-pane -R"
bind -n C-\ if-shell "$is_vim" "send-keys C-\\" "select-pane -l"

# Use vi movement keys for cycling panes
# Add -r flag after bind-key for repeats (messes with vim usually)
# bind-key h select-pane -L
# bind-key j select-pane -D
# bind-key k select-pane -U
# bind-key l select-pane -R

# Use capitalized vi movement keys for resizing panes
bind-key -r H resize-pane -L 5
bind-key -r J resize-pane -D 5
bind-key -r K resize-pane -U 5
bind-key -r L resize-pane -R 5

# Split panes with visually associated characters
bind | split-window -h
bind - split-window -v

# Set up reattach-to-user-namespace
# Originally added so gulp-notify -> node-notify -> terminal-notifier works
# Need to run this first to install: brew up && brew install reattach-to-user-namespace
# Found at https://github.com/mikaelbr/gulp-notify/issues/73
set-option -g default-command "which reattach-to-user-namespace > /dev/null && reattach-to-user-namespace -l $SHELL || $SHELL"

# Load Tmuxline snapshot (color scheme, separators, etc)
if-shell "test -f ~/.tmuxline-snapshot" "source ~/.tmuxline-snapshot"
